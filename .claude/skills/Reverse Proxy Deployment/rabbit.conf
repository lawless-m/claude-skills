# Invoice OCR (Rabbit) Reverse Proxy Configuration
# Location: /etc/apache2/proxy-conf.d/rabbit.conf on rivsprod01
# Public URL: https://dw.ramsden-international.com/rabbit/

# Backend API - Inference server (must come first - more specific path)
# Strips /rabbit/api prefix and forwards to inference server on port 8765
ProxyPass /rabbit/api/ http://10.99.0.3:8765/
ProxyPassReverse /rabbit/api/ http://10.99.0.3:8765/

# Frontend - Static web interface (less specific path comes second)
# Strips /rabbit prefix and forwards to web server on port 9273
ProxyPass /rabbit/ http://10.99.0.3:9273/
ProxyPassReverse /rabbit/ http://10.99.0.3:9273/

# This configuration:
# - Routes https://dw.ramsden-international.com/rabbit/ to frontend (port 9273)
# - Routes https://dw.ramsden-international.com/rabbit/api/* to backend API (port 8765)
# - Strips /rabbit/ or /rabbit/api/ prefix before forwarding to backend services
# - Trailing slashes are critical for proper path stripping

# Reload Apache after changes:
# ssh rivsprod01 "sudo systemctl reload apache2"
